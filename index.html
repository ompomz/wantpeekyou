<!DOCTYPE html>
<html lang="ja">
<head>
 <meta charset="UTF-8">
 <meta name="viewport" content="width=device-width, initial-scale=1.0">
 <title>want peek you</title>
 <style>
* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}
body {
  font-weight: 400;
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
  padding: .5rem;
  line-height: 1.3;
  background-color: #f7f7f7;
  color: #666;
  font-size: .9rem;
}
#container {
  max-width: 600px;
  margin: 1rem auto;
  padding: .5rem;
  background: #fff;
  border: 1px solid #ddd;
  border-radius: 8px;
}
h4 {
  font-size: 1.2rem;
  margin-bottom: .5rem;
}
input, textarea, select {
  transition: background-color 0.3s, color 0.3s;
  font-size: .9rem;
  padding: .5rem;
  border: 1px solid #ddd;
  border-radius: 4px;
  color: #666;
  background-color: #fff;
  width: 100%;
  margin-bottom: .5rem;
}
textarea {
  resize: vertical;
}
.container-button {
  white-space: nowrap;
  font-size: .8rem;
  font-weight: 700;
  padding: .25rem 1rem;
  margin: .5rem 0;
  border: none;
  border-radius: 999px;
  color: #fff;
  background-color: #666;
  cursor: pointer;
  transition: background-color 0.3s ease;
}
.container-button:hover {
  background-color: #444;
}
.container-button:disabled {
  background-color: #ccc;
  cursor: not-allowed;
}
.flex-container {
  display: flex;
  gap: .5rem;
  margin: .5rem 0;
}
.flex-item {
  flex: 1;
}
pre {
  background: #f0f0f0;
  padding: .5rem;
  border-radius: 4px;
  min-height: 100px;
  overflow-x: auto;
  font-size: .85rem;
}
.auth-status {
  background: #e0f2f1;
  padding: .5rem;
  border-radius: 4px;
  margin: .5rem 0;
  font-size: .85rem;
}
.auth-status.readonly {
  background: #fff3e0;
}
.auth-buttons {
  display: flex;
  gap: .5rem;
  flex-wrap: wrap;
}
#decrypt-auth-panel {
  background: #fff9c4;
  border: 2px solid #fbc02d;
  padding: 1rem;
  border-radius: 8px;
  margin: 1rem 0;
}
#decrypt-auth-panel h5 {
  margin-bottom: .5rem;
  color: #f57f17;
}
.warning-text {
  color: #d32f2f;
  font-size: .85rem;
  margin: .5rem 0;
}
@media (max-width: 767px) {
  #container {
    max-width: 100%;
    padding: 8px;
    margin: 0;
  }
  .flex-container {
    flex-direction: column;
  }
}
 </style>
</head>
<body>
 <div id="header-placeholder"></div>
 <h4>want peek you</h4>
 <span>Nostr kind:30000 Event Manager</span>
 
 <div id="container">
   <div id="loader" style="display:none;"><p>now loading...</p></div>
   
   <!-- èªè¨¼çŠ¶æ…‹è¡¨ç¤º -->
   <div id="auth-status" class="auth-status">
     <strong>ãƒ­ã‚°ã‚¤ãƒ³çŠ¶æ…‹:</strong> <span id="auth-status-text">æœªãƒ­ã‚°ã‚¤ãƒ³</span>
   </div>
   
   <!-- èªè¨¼ãƒœã‚¿ãƒ³ -->
   <div class="auth-buttons">
     <button class="container-button" onclick="showAuthUI()">ãƒ­ã‚°ã‚¤ãƒ³ / éµç®¡ç†</button>
     <button class="container-button" id="logout-button" style="display:none;">ãƒ­ã‚°ã‚¢ã‚¦ãƒˆ</button>
   </div>

   <label for="relayInput">ä½¿ç”¨ã™ã‚‹ãƒªãƒ¬ãƒ¼(æ”¹è¡Œ&ã‚³ãƒ³ãƒåŒºåˆ‡ã‚Šã€ç©ºæ¬„ã§ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆãƒªãƒ¬ãƒ¼ã‚’ä½¿ç”¨)</label>
   <textarea id="relayInput" placeholder="wss://relay.nostr.band/,wss://nos.lol/"></textarea>

   <button class="container-button" id="fetchEventsButton">ãƒªã‚¹ãƒˆã‚’èª­ã¿è¾¼ã¿</button>
   <button class="container-button" id="showNewListButton">æ–°è¦ãƒªã‚¹ãƒˆä½œæˆ</button>
   
   <label for="dTagSelect">æ—¢å­˜ãƒªã‚¹ãƒˆã‚’é¸æŠ</label>
   <select id="dTagSelect" disabled>
     <option value="">ãƒªã‚¹ãƒˆã‚’é¸æŠã—ã¦ãã ã•ã„</option>
   </select>
   
   <div id="newListFormContainer" style="display:none;">
     <label for="newDTagInput">æ–°ã—ã„ãƒªã‚¹ãƒˆå</label>
     <input type="text" id="newDTagInput" placeholder="ä¾‹: unmissable">
   </div>

   <!-- å¾©å·ç”¨ã®èªè¨¼ãƒ‘ãƒãƒ«ï¼ˆéå…¬é–‹ãƒªã‚¹ãƒˆç·¨é›†æ™‚ã®ã¿è¡¨ç¤ºï¼‰ -->
   <div id="decrypt-auth-panel" style="display:none;">
     <h5>ğŸ” éå…¬é–‹ãƒªã‚¹ãƒˆã®å¾©å·</h5>
     <p class="warning-text">éå…¬é–‹ãƒªã‚¹ãƒˆã‚’ç·¨é›†ã™ã‚‹ã«ã¯ã€ç§˜å¯†éµã¾ãŸã¯NIP-07æ‹¡å¼µæ©Ÿèƒ½ãŒå¿…è¦ã§ã™ã€‚</p>
     
     <div style="margin: .5rem 0;">
       <button class="container-button" id="decrypt-with-extension">NIP-07æ‹¡å¼µæ©Ÿèƒ½ã§å¾©å·</button>
     </div>
     
     <div style="margin: .5rem 0;">
       <label for="decrypt-nsec-input">ã¾ãŸã¯ç§˜å¯†éµ(nsec)ã‚’å…¥åŠ›:</label>
       <input type="password" id="decrypt-nsec-input" placeholder="nsec1...">
       <button class="container-button" id="decrypt-with-nsec">ã“ã®éµã§å¾©å·</button>
     </div>
     
     <button class="container-button" id="cancel-decrypt" style="background-color: #999;">ã‚­ãƒ£ãƒ³ã‚»ãƒ«</button>
   </div>

   <button class="container-button" id="decryptButton" disabled>ãƒªã‚¹ãƒˆã‚’ç·¨é›†</button>
   
   <div class="flex-container">
     <div class="flex-item">
       <label for="pTagsInput">Publicï¼ˆå…¬é–‹ãƒªã‚¹ãƒˆï¼‰</label>
       <textarea id="pTagsInput" rows="5" placeholder="ãƒªã‚¹ãƒˆã«å…¥ã‚ŒãŸã„äººã®å…¬é–‹éµã‚’hexå½¢å¼ã§å…¥åŠ›(æ”¹è¡Œã€ã‚«ãƒ³ãƒã€ã‚¹ãƒšãƒ¼ã‚¹åŒºåˆ‡ã‚Š)"></textarea>
     </div>
     <div class="flex-item">
       <label for="contentInput">Privateï¼ˆéå…¬é–‹ãƒªã‚¹ãƒˆï¼‰</label>
       <textarea id="contentInput" rows="5" placeholder="ãƒªã‚¹ãƒˆã«å…¥ã‚ŒãŸã„äººã®å…¬é–‹éµã‚’hexå½¢å¼ã§å…¥åŠ›(æ”¹è¡Œã€ã‚«ãƒ³ãƒã€ã‚¹ãƒšãƒ¼ã‚¹åŒºåˆ‡ã‚Š)" disabled></textarea>
       <small style="color: #999;">â€»éå…¬é–‹ãƒªã‚¹ãƒˆã®ç·¨é›†ã«ã¯ç§˜å¯†éµãŒå¿…è¦ã§ã™</small>
     </div>
   </div>
   
   <button class="container-button" id="generateButton" disabled>å¤‰æ›´å†…å®¹ã‚’æº–å‚™ï¼ˆéå…¬é–‹éƒ¨åˆ†ã‚’æš—å·åŒ–ï¼‰</button>
   
   <h5>ç”Ÿæˆã•ã‚ŒãŸJSON</h5>
   <pre id="generatedJson"></pre>
   
   <button class="container-button" id="updateButton" disabled>ãƒªã‚¹ãƒˆã‚’æ›´æ–°ã™ã‚‹</button>
   
   <div id="log" style="margin-top: 1rem; padding: .5rem; background: #f5f5f5; border-radius: 4px; max-height: 200px; overflow-y: auto;"></div>
 </div>

 <script src="https://ompomz.github.io/header/loadHeader.js"></script>
 <script src="https://unpkg.com/nostr-tools@2.17.0/lib/nostr.bundle.js"></script>
 <script src="https://ompomz.github.io/flowgazer/relay-manager.js"></script>
 <script src="https://ompomz.github.io/flowgazer/auth.js"></script>
 <script src="https://ompomz.github.io/flowgazer/auth-ui.js"></script>
 <script src="./script.js"></script>
</body>
</html>